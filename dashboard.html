<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <title>Dashboard - AYASH EARNING</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-950 text-white min-h-screen">

<nav class="p-4 bg-gray-900 flex justify-between">
  <h1 class="font-bold">AYASH EARNING</h1>
  <button id="logoutBtn" class="bg-red-500 px-3 py-1 rounded">‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</button>
</nav>

<div class="p-6 grid grid-cols-2 gap-4">
  <div class="bg-indigo-600 p-4 rounded-xl">Balance: $<span id="balance">0</span></div>
  <div class="bg-pink-600 p-4 rounded-xl">Clicks: <span id="clicks">0</span></div>
</div>

<section class="p-6">
  <h2 class="text-xl font-bold mb-2">PTC Ads</h2>
  <div class="bg-white/5 p-4 rounded-xl">
    <p>‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ü‡ßü ‡¶ï‡¶∞‡ßÅ‡¶®</p>
    <button id="viewAdBtn" class="mt-2 bg-green-600 px-4 py-2 rounded">View Ad (10s)</button>
    <p id="timer" class="mt-2 text-yellow-400 hidden">‡¶∏‡¶Æ‡ßü ‡¶¨‡¶æ‡¶ï‡¶ø: <span id="time">10</span>s</p>
  </div>
</section>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, doc, getDoc, updateDoc, increment } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBMKXazwuAHs4oujjZ75OFdP211nX45JU8",
  authDomain: "ayash-earning.firebaseapp.com",
  projectId: "ayash-earning",
  storageBucket: "ayash-earning.firebasestorage.app",
  messagingSenderId: "352126412047",
  appId: "1:352126412047:web:acb56ca67779de0baf8a7a"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const balanceEl = document.getElementById("balance");
const clicksEl = document.getElementById("clicks");
const btn = document.getElementById("viewAdBtn");
const timerEl = document.getElementById("timer");
const timeEl = document.getElementById("time");
const logoutBtn = document.getElementById("logoutBtn");

let uid = null;
let cooldown = false;

onAuthStateChanged(auth, async (user) => {
  if (!user) return window.location.href = "login.html";
  uid = user.uid;
  const snap = await getDoc(doc(db, "users", uid));
  const data = snap.data();
  balanceEl.innerText = data.balance.toFixed(2);
  clicksEl.innerText = data.clicks;
});

btn.onclick = async () => {
  if (cooldown) return alert("‡¶è‡¶ï‡¶ü‡ßÅ ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®!");
  cooldown = true;

  timerEl.classList.remove("hidden");
  let t = 10;
  timeEl.innerText = t;

  const interval = setInterval(async () => {
    t--;
    timeEl.innerText = t;
    if (t <= 0) {
      clearInterval(interval);
      timerEl.classList.add("hidden");
      await updateDoc(doc(db, "users", uid), {
        balance: increment(0.01),
        clicks: increment(1)
      });
      const snap = await getDoc(doc(db, "users", uid));
      balanceEl.innerText = snap.data().balance.toFixed(2);
      clicksEl.innerText = snap.data().clicks;
      cooldown = false;
      alert("‡¶Ö‡¶≠‡¶ø‡¶®‡¶®‡ßç‡¶¶‡¶®! $0.01 ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü‡ßá‡¶õ‡ßá üí∏");
    }
  }, 1000);
};

logoutBtn.onclick = () => signOut(auth).then(()=>window.location.href="login.html");
</script>

</body>
</html>
